<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.tenco.perfectfolio.repository.interfaces.NoticeRepository">

  <select id="getAllNotice" resultType="com.tenco.perfectfolio.repository.model.Notice">
    	SELECT * FROM notice_tb ORDER BY id DESC limit #{limit} offset #{offset}
    </select>
    
    <select id="getNoticeById" resultType="com.tenco.perfectfolio.repository.model.Notice">
    	SELECT * FROM notice_tb WHERE id = #{id}
    </select>
    
    <select id="getNoticeCount" resultType="int">
    	SELECT count(*) AS count FROM notice_tb
    </select>
    
    <insert id="addNotice">
    	INSERT INTO notice_tb(categories, title, content, created_at) values(#{categories}, #{title}, #{content}, now())
    </insert>
    
    
    <update id="updateNotice">
    	UPDATE notice_tb SET categories = #{categories}, title = #{title}, content = #{content} where id = #{id}
    </update>
    
    <delete id="deleteNotice">
    	DELETE FROM notice_tb WHERE id = #{id}
    </delete>
    
    <update id="incrementViewsCount">
    	UPDATE notice_tb SET views = views + 1 where id = #{id}
    </update>
    
    <select id="searchByCategories" resultType="com.tenco.perfectfolio.repository.model.Notice">
    	SELECT * FROM notice_tb WHERE categories LIKE CONCAT('%', #{keyword}, '%')  ORDER BY id DESC limit #{limit} offset #{offset}
    </select>
    
    <select id="searchByCategoriesCount" resultType="int">
    	SELECT COUNT(*) AS count FROM notice_tb WHERE categories LIKE CONCAT('%', #{keyword}, '%') 
    </select>
    
    <select id="searchByTitle" resultType="com.tenco.perfectfolio.repository.model.Notice">
    	SELECT * FROM notice_tb WHERE title LIKE  CONCAT('%', #{keyword}, '%')  ORDER BY id DESC limit #{limit} offset #{offset}
    </select>
    
    <select id="searchByTitleCount" resultType="int">
    	SELECT COUNT(*) AS count FROM notice_tb WHERE title LIKE  CONCAT('%', #{keyword}, '%') 
    </select>
    
    <select id="searchByTitleAndContent" resultType="com.tenco.perfectfolio.repository.model.Notice">
    	SELECT * FROM notice_tb WHERE title LIKE  CONCAT('%', #{keyword}, '%') AND content LIKE  CONCAT('%', #{keyword}, '%')  ORDER BY id DESC limit #{limit} offset #{offset}
    </select>
    
    <select id="searchByTitleAndContentCount" resultType="int">
    	SELECT COUNT(*) AS count FROM notice_tb WHERE title LIKE  CONCAT('%', #{keyword}, '%') AND content LIKE  CONCAT('%', #{keyword}, '%') 
    </select>
    
    <select id="getNoticeForMain">
    SELECT * FROM notice_tb ORDER BY id DESC LIMIT 3
    </select>

</mapper>